<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.repairsystem.dao.CompleteOrderMapper">
    <resultMap id="BaseResultMap" type="com.repairsystem.entity.CompleteOrder">
        <!--
          WARNING - @mbg.generatedgetCompleteOrderById
        -->
        <id column="order_id" property="orderId" jdbcType="INTEGER"/>
        <result column="admin_id" property="adminId" jdbcType="INTEGER"/>
        <result column="adminName" property="adminName" jdbcType="VARCHAR"/>
        <result column="complete_time" property="completeTime" jdbcType="TIMESTAMP"/>
        <result column="image_path" property="imagePath" jdbcType="VARCHAR"/>
        <result column="problem" property="problem" jdbcType="LONGVARCHAR"/>
        <result column="remark" property="remark" jdbcType="LONGVARCHAR"/>
    </resultMap>

    <select id="getAllCompleteOrder" resultMap="BaseResultMap">
      SELECT
        co.*, a.admin_name AS adminName
      FROM
        complete_order co,
        administrator a
      WHERE
        co.admin_id = a.admin_id
      ORDER BY
        co.complete_time DESC
  </select>
    <select id="getCompleteOrderById" resultMap="BaseResultMap" parameterType="java.lang.Integer">
        SELECT
            co.*, a.admin_name AS adminName
        FROM
            complete_order co,
            administrator a
        WHERE
            co.admin_id = a.admin_id
        AND co.order_id = #{id}
        ORDER BY
            co.complete_time DESC
    </select>

    <select id="getCompleteOrderCount" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM complete_order
    </select>

    <select id="getCompleteOrderByKeyWord" resultMap="BaseResultMap" parameterType="java.lang.String">
        SELECT
            co.*, a.admin_name AS adminName
        FROM
            complete_order AS co
        LEFT JOIN administrator AS a ON co.admin_id = a.admin_id
        WHERE
            co.problem LIKE "%"#{keyWord}"%"
        ORDER BY
            co.complete_time DESC
    </select>

</mapper>